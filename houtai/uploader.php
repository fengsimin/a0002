<?php
//Copyright (c) 2016 iFeiwu.com
 class Uploader extends Ifeiwu { function __construct() { } protected function postImage($request_data) { goto sko72; evCYI: if (!$handle->uploaded) { goto mgqHR; } goto B6kwq; EIjsW: goto QTdfD; goto ks4rL; bopn9: H_ZA0: goto YBgFi; rEehe: $handle->file_new_name_body = $file_new_name_body; goto RKlPw; Ow7K_: $_FILES["\146\151\x6c\x65"]["\164\x79\160\x65"] = $_POST["\x66\151\154\x65\x5f\164\x79\160\x65"]; goto tNPwk; di2PD: wQjrn: goto Ol6QC; qfma1: if ($image_resize == 1) { goto tPsax; } goto zM6yJ; sRhd8: $image_resize = $_POST["\151\155\x61\147\145\x5f\x72\145\x73\151\x7a\x65"]; goto ctQTh; eePjW: if (!$file_new_name_body) { goto hqr0l; } goto rEehe; M_Z8C: if (!empty($_FILES["\x66\x69\x6c\x65"])) { goto Brql2; } goto tTIvK; NrEkq: if (!$quality) { goto Xll_N; } goto Jz7v_; tNPwk: $_FILES["\146\x69\154\145"]["\x73\151\172\145"] = $_POST["\x66\151\x6c\145\x5f\x73\151\x7a\x65"]; goto z9l0M; URYkR: goto J47lE; goto bopn9; J069B: $image_convert = $_POST["\x69\155\141\x67\145\137\143\157\x6e\166\145\162\x74"]; goto ZAd1a; K__o0: Brql2: goto rJmS8; j8QZ9: $image_y = explode("\54", $_POST["\x69\x6d\141\147\145\x5f\x79"]); goto IsjFX; rJmS8: ifeiwu\Loader::import("\145\170\164\x65\156\144\x2f\125\160\154\157\141\144"); goto Elg62; lmrwo: Xll_N: goto b5j8h; sko72: $_FILES["\x66\x69\x6c\145"]["\x6e\141\155\x65"] = $_POST["\146\x69\x6c\x65\137\x6e\x61\155\145"]; goto Ow7K_; J28He: goto wQjrn; goto K__o0; zM6yJ: $quality = end($jpeg_quality); goto NrEkq; tsLUa: $image_x = explode("\x2c", $_POST["\151\155\141\147\145\137\170"]); goto j8QZ9; I91OX: $handle->file_overwrite = $file_overwrite ? true : false; goto LBkap; n9gqR: return $this->success('', array("\x70\141\x74\150" => $file_save_path, "\151\155\x61\147\145" => $handle->file_dst_name, "\x73\x69\x7a\x65" => $handle->file_src_size, "\167\x69\x64\164\150" => $handle->image_src_x, "\150\x65\x69\x67\x68\x74" => $handle->image_src_y, "\x74\171\x70\x65" => $handle->image_dst_type, "\x65\170\x74" => $handle->file_dst_name_ext)); goto XJInT; tTIvK: return $this->error("\xe6\227\xa0\346\225\210\xe7\x9a\204\346\x96\x87\344\xbb\xb6\344\277\xa1\xe6\201\257\357\xbc\201"); goto J28He; LBkap: $handle->Process($upload_root . "\57" . $file_save_path); goto EIjsW; FHSwF: BxFZF: goto W2peG; cSSLt: $handle->image_convert = $image_convert; goto OLuNy; IsjFX: foreach ($file_name_body_pre as $key => $prefix) { goto tCT2L; bMgm2: l4o12: goto x8w2_; Dc70f: $handle->image_ratio_y = true; goto BS3lP; dZh4x: $handle->image_convert = $image_convert; goto hc_FW; m8g1g: DJXIw: goto ZLEbO; VZap0: $handle->image_x = $handle->image_src_x; goto PNN4O; gP8u1: $handle->image_resize = $image_resize ? true : false; goto WSwOB; hc_FW: fqjUM: goto WcF_Z; H6goS: if ($height && $handle->image_src_y > $height) { goto RACw8; } goto Dc70f; BS3lP: goto timxX; goto OzFRY; ZLEbO: $handle->file_overwrite = $file_overwrite ? true : false; goto c716d; QeQKu: if (!$file_new_name_body) { goto DJXIw; } goto G7XIH; B3Jhw: JbBoV: goto GQQAm; m_5_s: $height = $image_y[$key]; goto DFdQ9; c716d: $handle->Process($upload_root . "\x2f" . $file_save_path); goto g940d; g940d: McUYk: goto xkrWk; fY_De: vrjq6: goto H6goS; i8t3w: $handle->jpeg_quality = $quality; goto bMgm2; WSwOB: $handle->file_name_body_pre = $prefix; goto fopu4; tCT2L: $width = $image_x[$key]; goto m_5_s; BCWPz: $handle->image_y = $height; goto TfWK9; TfWK9: timxX: goto QeQKu; x8w2_: if (!$image_convert) { goto fqjUM; } goto dZh4x; GQQAm: $handle->image_x = $width; goto fY_De; PNN4O: goto vrjq6; goto B3Jhw; ZWhRn: if (!$prefix) { goto s8lhf; } goto gP8u1; fopu4: s8lhf: goto o_FTk; DFdQ9: $quality = $jpeg_quality[$key]; goto ZWhRn; G7XIH: $handle->file_new_name_body = $file_new_name_body; goto m8g1g; OzFRY: RACw8: goto BCWPz; WcF_Z: if ($width && $handle->image_src_x > $width) { goto JbBoV; } goto VZap0; o_FTk: if (!$quality) { goto l4o12; } goto i8t3w; xkrWk: } goto FHSwF; z5Eqq: if ($handle->processed) { goto H_ZA0; } goto tfCmP; DNguq: $file_save_path = ''; goto YxztM; ks4rL: tPsax: goto etFEy; YxztM: GQsa_: goto n9gqR; PkUH3: $file_new_name_body = $_POST["\146\151\x6c\x65\137\x6e\x65\x77\x5f\156\141\155\x65\x5f\142\157\x64\x79"]; goto tyMBr; ZAd1a: $jpeg_quality = explode("\x2c", $_POST["\152\160\145\x67\x5f\x71\x75\x61\x6c\151\x74\171"]); goto qfma1; sIlKe: mgqHR: goto z5Eqq; etFEy: $file_name_body_pre = explode("\54", $_POST["\146\x69\154\x65\x5f\x6e\x61\155\x65\x5f\142\x6f\144\x79\x5f\x70\x72\x65"]); goto tsLUa; b5j8h: if (!$image_convert) { goto hfPGo; } goto cSSLt; ctQTh: $file_save_path = $_POST["\x66\x69\x6c\x65\137\x73\x61\166\x65\x5f\x70\x61\164\150"]; goto J069B; tyMBr: $file_overwrite = $_POST["\146\x69\154\x65\137\x6f\166\145\162\167\x72\151\x74\145"]; goto sRhd8; Jz7v_: $handle->jpeg_quality = $quality; goto lmrwo; tfCmP: return $this->error($handle->log); goto URYkR; RKlPw: hqr0l: goto I91OX; YBgFi: if (!($file_save_path == "\x2f")) { goto GQsa_; } goto DNguq; XJInT: J47lE: goto di2PD; OLuNy: hfPGo: goto eePjW; W2peG: QTdfD: goto sIlKe; Elg62: $handle = new Upload($_FILES["\x66\151\154\145"]); goto evCYI; z9l0M: $_FILES["\x66\151\x6c\145"]["\145\162\162\x6f\162"] = $_POST["\146\151\154\x65\x5f\x65\x72\x72\x6f\162"]; goto M_Z8C; B6kwq: $upload_root = "\56\56\x2f"; goto PkUH3; Ol6QC: } protected function postFile($request_data) { goto P_qdb; j2UI8: lI4Xv: goto CGHGR; FfkuL: $_FILES["\x66\x69\x6c\x65"]["\145\x72\x72\x6f\x72"] = $_POST["\x66\x69\x6c\145\x5f\145\x72\x72\157\x72"]; goto ETe7Y; r8Rft: XcN6w: goto f1osG; RmFPh: mkdir($temp_dir, 511, true); goto GebHk; fXQ2n: eJ874: goto Bnmt7; VIYCE: $_FILES["\146\x69\x6c\x65"]["\x6e\141\155\145"] = $_POST["\x66\x69\154\145\137\156\141\155\145"]; goto cJ_GG; f1osG: $this->_debug("\x45\x72\162\x6f\162\x20\163\x61\x76\151\x6e\x67\x20\x28\x6d\x6f\x76\145\137\x75\160\x6c\x6f\141\144\x65\144\137\146\151\x6c\145\51\40\x63\x68\165\156\153\40" . $resumableChunkNumber . "\40\x66\157\x72\40\x66\151\154\145\40" . $resumableFilename); goto fXQ2n; GebHk: vkXvX: goto VrYDo; SJYYT: $_FILES["\146\151\x6c\145"]["\163\x69\172\145"] = $_POST["\x66\151\x6c\x65\137\163\x69\x7a\145"]; goto FfkuL; VrYDo: if (!move_uploaded_file($file["\x74\x6d\160\x5f\156\141\x6d\145"], $dest_file)) { goto XcN6w; } goto nbi2G; tA0RW: $this->_debug("\145\162\162\x6f\x72\40" . $file["\x65\162\x72\x6f\x72"] . "\40\151\x6e\x20\146\x69\x6c\145\x20" . $resumableFilename); goto j2UI8; wh3X1: $dest_file = $temp_dir . "\57" . $resumableFilename . "\x2e\x70\x61\x72\x74" . $resumableChunkNumber; goto svtxo; cJ_GG: $_FILES["\146\151\154\145"]["\164\171\x70\x65"] = $_POST["\x66\151\x6c\x65\137\x74\x79\x70\145"]; goto SJYYT; P_qdb: $save_path = "\56\56\57" . $this->_UTF82GBK($_POST["\163\141\x76\x65\137\x70\141\x74\150"]); goto ziSiq; WcW3J: $resumableChunkNumber = $_POST["\x72\x65\x73\165\x6d\x61\x62\154\x65\x43\x68\165\x6e\153\x4e\165\x6d\x62\145\162"]; goto fSHld; svtxo: if (is_dir($temp_dir)) { goto vkXvX; } goto RmFPh; CGHGR: $temp_dir = $save_path . "\57" . $resumableIdentifier; goto wh3X1; iziac: if (!($file["\x65\162\x72\x6f\x72"] != 0)) { goto lI4Xv; } goto tA0RW; nbi2G: $this->_createFileFromChunks($save_path, $temp_dir, $resumableFilename, $_POST["\x72\x65\x73\165\155\x61\142\x6c\145\x43\x68\165\x6e\153\x53\x69\x7a\145"], $_POST["\162\x65\x73\165\x6d\x61\x62\x6c\145\x54\x6f\164\141\x6c\x53\x69\x7a\x65"]); goto iw6Wh; ziSiq: $resumableFilename = $this->_UTF82GBK($_POST["\162\145\x73\165\155\x61\x62\154\x65\x46\151\x6c\145\156\x61\x6d\145"]); goto WcW3J; iw6Wh: goto eJ874; goto r8Rft; ETe7Y: $file = $_FILES["\x66\151\154\145"]; goto iziac; fSHld: $resumableIdentifier = $_POST["\162\145\x73\x75\155\x61\142\154\145\111\144\145\x6e\x74\151\x66\151\145\x72"]; goto VIYCE; Bnmt7: } protected function getFile() { goto FFBd7; ItsT1: $chunk_file = $temp_dir . "\57" . $resumableFilename . "\56\x70\x61\x72\x74" . $resumableChunkNumber; goto mXViy; kZvi9: $resumableChunkNumber = $_GET["\162\145\163\165\x6d\x61\x62\154\145\103\150\165\x6e\x6b\x4e\x75\155\x62\145\162"]; goto lEWhx; acvHC: return 404; goto kxL_B; vutc2: Hm98Q: goto uAY60; lEWhx: $resumableIdentifier = $_GET["\x72\145\163\x75\x6d\x61\142\154\x65\111\x64\x65\156\x74\151\146\151\145\x72"]; goto R2i1g; mXViy: if (file_exists($chunk_file)) { goto J1Tdm; } goto acvHC; oU4vO: return 202; goto vutc2; uqegb: $resumableFilename = $this->_UTF82GBK($_GET["\x72\145\163\165\x6d\141\142\154\x65\x46\151\x6c\x65\x6e\x61\155\x65"]); goto kZvi9; kxL_B: goto Hm98Q; goto dv9rB; FFBd7: $save_path = "\x2e\x2e\x2f" . $this->_UTF82GBK($_GET["\x73\141\166\145\137\x70\x61\x74\x68"]); goto uqegb; R2i1g: $temp_dir = $save_path . "\x2f" . $resumableIdentifier; goto ItsT1; dv9rB: J1Tdm: goto oU4vO; uAY60: } private function _createFileFromChunks($save_path, $temp_dir, $fileName, $chunkSize, $totalSize) { goto lvvZU; IqSzq: if (!($i <= $total_files)) { goto nrDbZ; } goto pKHhh; jDcEV: mhIGz: goto IqSzq; lvvZU: $total_files = 0; goto syApZ; YxMTg: if (rename($temp_dir, $temp_dir . "\137\x55\x4e\125\x53\105\x44")) { goto K6aNk; } goto guMkT; m6X3E: if (!($total_files * $chunkSize >= $totalSize - $chunkSize + 1)) { goto QqmDu; } goto VQDwp; pKFd5: s3Vni: goto m6X3E; J99Ke: $i++; goto mXaFr; oDtU1: $this->_debug("\143\x61\156\156\157\164\x20\143\162\x65\141\164\145\x20\x74\150\145\x20\144\x65\x73\x74\151\156\141\x74\x69\x6f\x6e\x20\x66\151\154\145"); goto Y3Um4; QoKYv: $i = 1; goto jDcEV; yP60t: TCW30: goto YxMTg; mXaFr: goto mhIGz; goto SMzWi; guMkT: $this->_rrmdir($temp_dir); goto c4Me1; pKHhh: fwrite($fp, file_get_contents($temp_dir . "\x2f" . $fileName . "\x2e\160\x61\162\x74" . $i)); goto Ow3V8; MaPY0: $this->_rrmdir($temp_dir . "\x5f\125\x4e\125\x53\105\104"); goto EmRs1; MKPMC: K6aNk: goto MaPY0; HXrA6: goto TCW30; goto KkOyh; MKJT5: QqmDu: goto WeJ6R; S1qh0: fclose($fp); goto yP60t; syApZ: foreach (scandir($temp_dir) as $file) { goto Gsujt; Gsujt: if (!(stripos($file, $fileName) !== false)) { goto UB7Rq; } goto zejLd; fo0PI: aUlOb: goto pERgd; zejLd: $total_files++; goto AGGLW; AGGLW: UB7Rq: goto fo0PI; pERgd: } goto pKFd5; c4Me1: goto opOu_; goto MKPMC; Ow3V8: tSORS: goto J99Ke; SMzWi: nrDbZ: goto S1qh0; KkOyh: QLz0M: goto QoKYv; Y3Um4: return false; goto HXrA6; EmRs1: opOu_: goto MKJT5; VQDwp: if (($fp = fopen($save_path . "\57" . $fileName, "\167")) !== false) { goto QLz0M; } goto oDtU1; WeJ6R: } private function _rrmdir($dir) { goto Y2kny; Hn5OH: reset($objects); goto xDj90; xDj90: rmdir($dir); goto jOlWm; MdjzY: foreach ($objects as $object) { goto KVPVq; ZpE9M: if (filetype($dir . "\x2f" . $object) == "\x64\x69\x72") { goto I4syB; } goto CBwIr; cFWP0: I4syB: goto zZ71m; XepzO: uBUXv: goto qQmX2; CBwIr: unlink($dir . "\x2f" . $object); goto Mgt2I; qQmX2: ODzJx: goto MqpDu; zZ71m: $this->_rrmdir($dir . "\x2f" . $object); goto XepzO; MqpDu: xqFzu: goto sFLr0; KVPVq: if (!($object != "\x2e" && $object != "\56\x2e")) { goto ODzJx; } goto ZpE9M; Mgt2I: goto uBUXv; goto cFWP0; sFLr0: } goto oL6LA; oL6LA: FiZD4: goto Hn5OH; Y2kny: if (!is_dir($dir)) { goto SMOee; } goto w2esP; w2esP: $objects = scandir($dir); goto MdjzY; jOlWm: SMOee: goto vFh71; vFh71: } }
